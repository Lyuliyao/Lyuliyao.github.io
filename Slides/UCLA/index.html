<!--
title:Construction of Coarse-Grained Molecular Dynamics with Many-Body Non-Markovian Memory
abstract:
We introduce a machine-learning-based coarse-grained molecular dynamics (CGMD) model that faithfully retains the many-body nature of the inter-molecular dissipative interactions. Unlike the common empirical CG models, the present model is constructed based on the Mori-Zwanzig formalism and naturally inherits the heterogeneous statedependent memory term rather than matching the meanfield metrics such as the velocity auto-correlation function. Numerical results show that preserving the many-body nature of the memory term is crucial for predicting the collective transport and diffusion processes, where empirical forms generally show limitations.
-->

<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>Machine Learning-based Coarse-Grained models for molecular systems</title>
		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/serif.css">
		<style>	
		.tight-math mjx-container[jax="CHTML"][display="true"],
		.tight-math .MathJax_Display {
		margin: 0.2em 0 !important;
		}
		div.highlight {
			background-color:#FFF9C4;
			text-align: left;
			 margin-top: 20px; 
			 padding: 15px; 
			 border-radius: 8px; 
			 box-shadow: 2px 2px 10px #ccc;
		}
		div.model {
			display: flex;
			justify-content: space-between;
			align-items: center; /* This will vertically center the content */
			margin: 20px 0;
			padding: 10px;
			border: 1px solid #ddd;
			border-radius: 5px;
		}
		div.model .name {
			margin: 0;
			flex: 1;
			color: #444;
			display: flex;
			align-items: center; /* This will vertically center the text */
			justify-content: flex-end; /* This will align the text to the right */
			padding-right: 20px; /* Some spacing between the name and the equation */
		}
		div.model .equation {
			flex: 2;
		}
			figcaption {
			  color: black;
			  font-style: italic;
			  padding: 2px;
			  font-size:large;
			  text-align: center;
			}
			.particle {
				fill: #1976D2;
				stroke: black;
				stroke-width: 1;
			}
			.bond {
				stroke: black;
				stroke-width: 2;
			}
			cite {
				font-size: 0.4em; /* Adjust the font size as needed */
				display: block; /* Optional: To make the citation appear on a new line */
				color:#444
			}
			.theorem, .proposition {
				border: 1px solid #000;
				padding: 10px;
				margin: 10px 0;
			}
			.theorem {
				background-color: #f0f0f0;
			}
			.proposition {
				background-color: #e0e0e0;
			}
			.theorem h4, .proposition h4 {
				margin: 0;
				font-size: 1em;
			}
			.content {
				margin-top: 5px;
				font-size: 1em;
			}
			
		</style>
		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
		<script src="https://d3js.org/d3.v5.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script>
		<script type="text/x-mathjax-config">
			MathJax.Hub.Register.StartupHook("TeX color Ready", function() {
				MathJax.Extension["TeX/color"].colors["myred"] = '#E65100';
		   });
			MathJax.Hub.Config({
			  TeX: {
				Macros: {
					bm: ["{\\mathbf{#1}}", 1],
					mb: ["{\\mathbf{#1}}", 1],
			   diff: "\\mathop{}\\!\\mathrm{d}",
			   MLMN: "\\mathcal{L}_\\mathcal{N}",
			   bz: "\\mathbf{z}",
			   bZ: "\\mathbf{Z}",
			   bp: "\\mathbf{p}",
			   bq: "\\mathbf{q}",
			   bP: "\\mathbf{P}",
			   bQ: "\\mathbf{Q}",
			   bV: "\\mathbf{V}",
			   br: "\\mathbf{r}",
			   bs: "\\mathbf{s}",
			   bF: "\\mathbf{F}",
			   CM: "\\mathcal M_\\beta",
			   l: "\\left",
			   r: "\\right",
			   intd: "\\mathrm{d}",
			   mbm:"\\mathbf{m}",
				}
			  }
			});
		  </script>
		<script type="text/javascript">
		window.PlotlyConfig = {MathJaxConfig: 'local'};
		</script>
		<script src="https://cdn.plot.ly/plotly-2.9.0.js"></script>
		<script src="./figure/md.js"></script>
		<script src="./figure/title.js"></script>

	</head>
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-CQSV68665C"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'G-CQSV68665C');
	</script>
	<body>
		<div class="reveal">
			<div class="slides">
				<!-- <section data-menu-title="Coarse-Grained Molecular Dynamics" >
					<div style="text-align: center; font-weight: 700;">
						<h1 id="title-text2" style="font-size: 1.5em; color: #2c3e50;"></h1>
					</div>
					<div style="text-align: center; margin-top: 20px;">
						<svg id="MD1" width="750" height="300" style="border: none;"></svg>
						<button id="updateValues1" style="padding: 8px 15px; border: none; border-radius: 5px;font-style: serif; font-size: 1.0em; font-weight: bold; color: #2c3e50;"></button>
						<div>
							<script>
								title("MD1", "updateValues1", 30, 0.75);
							</script>
						</div>
					</div>
					<div style="text-align: center; font-weight: 400; margin-top: -10px;">
						<p id="author2" style="margin-bottom: 2px; font-size: 1.3em; font-weight: bold; color: #2c3e50;"></p>
						<p id="department2" style="margin-bottom: 2px; font-size: 1.1em; color: #34495e;"></p>
						<p id="school2" style="margin-bottom: 0; font-size: 1.1em; font-weight: bold; color: #34495e;"></p>
						<p id="Cooperator" style="margin-bottom: 0; font-size: 1.1em; font-weight: bold; color: #34495e;"></p>
					</div>
				
					<script>
						function typeText(elementId, text, speed) {
							let i = 0;
							function type() {
								if (i < text.length) {
									document.getElementById(elementId).innerHTML += text.charAt(i);
									i++;
									setTimeout(type, speed);
								}
							}
							type();
						}
						document.addEventListener("DOMContentLoaded", function () {
							typeText("title-text2", "Machine Learning-based Coarse-Grained models for molecular systems", 30);
							setTimeout(() => typeText("author2", "Liyao Lyu", 30), 2000);
							setTimeout(() => typeText("department2", "Department of Mathematics", 30), 2500);
							setTimeout(() => typeText("school2", "University of California, Los Angeles", 30), 3000);
							setTimeout(() => typeText("Cooperator", "Joint work with Huan Lei (MSU) ", 30), 3500);
						});
					</script>
				
					<aside class="notes">
						<ul>
						Today, I will discuss Coarse-Grained Molecular Dynamics with Many-Body Non-Markovian Memory.	
						The central challenge we address is this: How do we bridge high-resolution atomistic simulations to mesoscale phenomena?
						Atomistic simulations track every atomic detail but computationally impossible for large systems.
						Coarse-grained (CG) models simplify this by focusing on collective variables, like the center of mass (dashed circles), rather than individual atoms (solid circles).
						But existing CG models often oversimplify memory effects. Our work introduces a framework that retains these critical many-body, non-Markovian features while preserving computational efficiency. 
						</ul>
					</aside>
				</section> -->
				<section data-menu-title="Coarse-Grained Molecular Dynamics"
						style="display: flex; flex-direction: column; align-items: center; justify-content: flex-start; height: 100%;">

				<!-- 标题 -->
				<h1 id="title-text2" style="margin-top: 10px; font-size: 1.5em; color: #2c3e50; font-weight: 700;"></h1>

				<!-- 中间的图和按钮 -->
				<svg id="MD1" width="750" height="300" style="margin-top: 20px; border: none;"></svg>
				<button id="updateValues1"
						style="margin-top: 10px; padding: 8px 15px; border: none; border-radius: 5px; font-style: serif; font-size: 1.0em; font-weight: bold; color: #2c3e50;"></button>
				<div>
					<script>
					title("MD1", "updateValues1", 30, 0.75);
					</script>
				</div>

				<!-- 作者信息 -->
				<!-- <p id="author2" style="margin-top: 20px; margin-bottom: 2px; font-size: 1.1em; font-weight: bold; color: #2c3e50;"></p>
				<p id="department2" style="margin-bottom: 2px; font-size: 1.1em; color: #34495e;"></p>
				<p id="school2" style="margin-bottom: 0; font-size: 1.1em; font-weight: bold; color: #34495e;"></p>
				<p id="Cooperator" style="margin-bottom: 0; font-size: 1.1em; font-weight: bold; color: #34495e;"></p> -->
				<div style="text-align: center; font-size: 1.1em; color: #34495e; margin-top: 10px; line-height: 1.4;">
				<span id="author2" style="font-size: 1.3em; font-weight: bold; color: #2c3e50;"></span><br>
				<span id="department2"></span><br>
				<span id="school2" style="font-weight: bold;"></span><br>
				<span id="Cooperator" style="font-weight: bold;"></span>
				</div>
				<!-- 打字动画 -->
				<script>
					function typeText(elementId, text, speed) {
					let i = 0;
					function type() {
						if (i < text.length) {
						document.getElementById(elementId).innerHTML += text.charAt(i);
						i++;
						setTimeout(type, speed);
						}
					}
					type();
					}

					document.addEventListener("DOMContentLoaded", function () {
					typeText("title-text2", "Machine Learning-based Coarse-Grained models for molecular systems", 30);
					setTimeout(() => typeText("author2", "Liyao Lyu", 30), 2000);
					setTimeout(() => typeText("department2", "Department of Mathematics", 30), 2500);
					setTimeout(() => typeText("school2", "University of California, Los Angeles", 30), 3000);
					setTimeout(() => typeText("Cooperator", "Joint work with Huan Lei (MSU) ", 30), 3500);
					});
				</script>

				<!-- 演讲备注 -->
				<aside class="notes">
					<ul>
					<li>Today, I will discuss Coarse-Grained Molecular Dynamics with Many-Body Non-Markovian Memory.</li>
					<li>The central challenge we address is this: How do we bridge high-resolution atomistic simulations to mesoscale phenomena?</li>
					<li>Atomistic simulations track every atomic detail but computationally impossible for large systems.</li>
					<li>Coarse-grained (CG) models simplify this by focusing on collective variables, like the center of mass (dashed circles), rather than individual atoms (solid circles).</li>
					<li>But existing CG models often oversimplify memory effects. Our work introduces a framework that retains these critical many-body, non-Markovian features while preserving computational efficiency.</li>
					</ul>
				</aside>
				</section>

				<section data-auto-animate data-menu-title="Multi-scale modeling:Background">
					<h3>
						<div style="display:inline">
							Multi-scale modeling:
						</div> 
						<div style="display:inline">
							Background 
						</div>
					</h3>
					<div style="display: flex; align-items: center; justify-content: center; width: 100%;">
						<div class="fragment fade-in-then-semi-out"  data-fragment-index="1" style="width:500px">
							<figure>
								<p><img src="./figure/Dirac.png"
									style="width:300px; object-fit: cover;"
									alt="Eiffel tower">
								</p>
								<div style="opacity: 0.5; font-size: 0.6em; text-align: left;">
									Dirac, Paul Adrien Maurice.
									Quantum mechanics of many-electron systems.
								</div>
							</figure>
						</div>
						<div style="text-align: left;">
							<div class="fragment fade-in-then-semi-out"  data-fragment-index="1"  style="margin-bottom: 50px; margin-right: 100px;">
									The right physical principle for most of what we are interested in is already provided by the principles of quantum mechanics (QM). <br>
							</div>
							<div class="fragment fade-in-then-semi-out"  data-fragment-index="2"  style="margin-left:100px;">
								The ability to reduce everything to simple fundamental laws does not imply the ability to start from those laws and reconstruct the universe.
							</div>
							<div class="fragment fade-in-then-semi-out"  data-fragment-index="2"  style="margin-left:100px;">
									The constructionist hypothesis breaks
									down when confronted with <span style="color:#E65100">the twin
									difficulties of scale and complexity.</span>
							</div>
						</div>
						<div class="fragment fade-in-then-semi-out"  data-fragment-index="2"  style="width:500px">
							<figure>
								<p><img src="./figure/Andersonphoto-removebg.png"
									style="width:300px; object-fit: cover;"
									alt="Eiffel tower">
								</p>
								<div style="opacity: 0.5; font-size: 0.6em; text-align: left; position: absolute;">
									Anderson, Philip W.
									More Is Different: Broken symmetry and the nature of the hierarchical structure of science.
								</div>
							</figure>
						</div>
					</div>
					<div class="fragment fade-in-then-semi-out"  data-fragment-index="3" style="text-align: left; margin-left:100px;">
						<br>
						<span style="color:#E65100">Scale - High Dimensionality - Curse of Dimensionality </span> <br>
						<span style="color:#E65100">Complexity - Empirical Model - Oversimplification</span>
					</div>
				</section>		
				<section data-auto-animate>
					<h3>Mori-Zwanzig Formalism</h3>
				
					<div style="text-align: left;">
						<p>In the <b>Mori-Zwanzig formalism</b>, the dynamics of the <b>coarse-grained (CG) variables</b>
						   follow:
						</p>
					</div>
				
					<div data-id="MZCG">
						\[
						\begin{aligned}
						\dot{\mathbf{Q}} &= \mathbf M^{-1} \mathbf{P}, \\
						\dot{\mathbf{P}} &= 
						\underbrace{-\nabla U(\mathbf{Q})}_{\text{Conservative Force}} 
						- \underbrace{\int_0^t {\mathbf{K}(\mathbf{Q}(s), t-s) }\mathbf{V}(s) ds}_{\text{Memory Contribution}} 
						+ \underbrace{\mathbf{R}(t)}_{\text{Random Force}}.
						\end{aligned}
						\]
					</div>

					<div style="display: flex; justify-content: center; margin-top: 10px;">
						<ul class="fragment fade-in" style="list-style: none; padding: 0; display: grid; grid-template-columns: repeat(2, minmax(200px, 1000px)); ">
							<li><b>\( \mathbf{Q} \)</b>: Center of mass</li>	
							<li><b>\( \mathbf{P} \)</b>: Total momentum</li>	
							<li><b>\( \mathbf{V} \)</b>: Velocity</li>	
							<li><b>\( \mathbf{M} \)</b>: Mass matrix</li>
						</ul>
					</div>
					<div style="text-align: left;display: flex; margin-top: 10px; margin-bottom: 20px">
						<ul>
							<li class="fragment fade-in-then-semi-out">
							The Mori-Zwanzig formalism is <span style="color:#E65100">general</span>. 
							</li>
							<li class="fragment fade-in-then-semi-out">
							In practice, one has to resort to <span style="color:#E65100">simple and ad hoc</span>  approximations.
						 	</li>
							<li class="fragment fade-in-then-semi-out">
								Oversimplification of Memory Contribution <span style="color:#E65100">under-explored</span>.
							</li>
						</ul>
					</div>
					<div style="opacity: 0.8; font-size: 0.8em; text-align: left; position: absolute;">
						<div>
							Zwanzig, Robert.
							Nonequilibrium statistical mechanics. Oxford university press, 2001.
						</div>
					</div>
				
					<aside class="notes">
						<ul>
							Theorically, the dynamics of the coarse-grained variable can be given by the Mori-Zwanzig formalism.
							Here Q is the center of mass and P its momentum respectively and M is the mass matrix. 
							The force term is decomposited into three part represents the convervative, memory and ramdom respectively.
							While the MZ is general, it do not give a closed-form expressions. 
							The formula of conservative force and the memory kernel as a function of CG variable Q is unknown.
							Mnay efforts has been focused on refining the conservative force—often using many-body potentials.
							However, oversimplication of the memory kernel has been overlooked, typically reduced to pairwise or isotropic terms.
							This oversight is consequential: as our numerical results will demonstrate, the memory kernel’s many-body, state-dependent nature is essential to reproduce dynamic properties like transport and hydrodynamic correlations. 
						</ul>
					</aside>
				</section>

				<section data-auto-animate>
					<h3>Ad hoc Approximations</h3>
					<div style="text-align: left; font-size: 1.1em; color: #2c3e50;">
						<p class="fragment fade-in" data-fragment-index="1">
							In the <b>Mori-Zwanzig formalism</b>, the dynamics of the <b>coarse-grained (CG) variables</b> are unknown. 
							Many existing models make <b>simplifying approximations</b>:
						</p>
					</div>
					<!-- Introductory Explanation

				
					<div data-id="MZCG">
						\[
						\begin{aligned}
						\dot{\mathbf{Q}} &= \mathbf M^{-1} \mathbf{P}, \\
						\dot{\mathbf{P}} &= 
						\underbrace{-\nabla U(\mathbf{Q})}_{\text{Conservative Force}} 
						- \underbrace{\int_0^t {\mathbf{K}(\mathbf{Q}(s), t-s) }\mathbf{V}(s) ds}_{\text{Memory Contribution}} 
						+ \underbrace{\mathbf{R}(t)}_{\text{Random Force}}.
						\end{aligned}
						\]
					</div> -->
				
					<!-- Comparative Diagram (Placeholder for Image)
					<div class="fragment fade-in" data-fragment-index="2" style="text-align: center; margin-top: 10px;">
						<img src="./figure/approximations_comparison.png" alt="Approximations Comparison Diagram" width="650px"
							 style="border-radius: 8px; box-shadow: 2px 2px 10px #bbb;">
					</div>
				 -->
					<!-- Equations for Different Models -->
					<div style="justify-content: center; margin-top: 10px; font-size: 0.8em">
						<ul style="list-style: none; padding: 0; 
								   display: grid; grid-template-columns: minmax(150px, 500px) minmax(300px, 600px);; 
								   gap: 15px; justify-content: center;">
						
							<!-- Markovian-Pairwise Model -->
							<li class="fragment fade-in-then-semi-out" data-fragment-index="3">
								<b>Markovian-Pairwise</b>
							</li>
							<li class="fragment fade-in-then-semi-out" data-fragment-index="3">
								\(
								\sum_{j} \mathbf{K}(Q_{ij}) \mathbf{V}_j .
								\)
							</li>
				
							<!-- Non-Markovian Isotropic Model -->
							<li class="fragment fade-in-then-semi-out" data-fragment-index="4">
								<b>Non-Markovian Isotropic</b>
							</li>
							<li class="fragment fade-in-then-semi-out" data-fragment-index="4">
								\(
								\int_0^t \mathbf{K}(t-s) \mathbf{V}(s).
								\)
							</li>
				
							<!-- Non-Markovian Pairwise Model -->
							<li class="fragment fade-in-then-semi-out" data-fragment-index="5">
								<b>Non-Markovian Pairwise (NM-DPD)</b>
							</li>
							<li class="fragment fade-in-then-semi-out" data-fragment-index="5">
								\(
								\sum_j \int_0^t \mathbf{K}(Q_{ij}, t-s) \mathbf{V}_{ij}(s) \, ds.
								\)
							</li>
				
							<!-- Our Model - Highlighted -->
							<li class="fragment fade-in" data-fragment-index="6">
								<b style="color: #E65100;font-size:1.2em">🚀 Non-Markovian Manybody (Our Model)</b>
							</li>
							<li class="fragment fade-in" data-fragment-index="6" style="border-left: 5px solid #E65100; padding-left: 10px;font-size: 1.2em;">
								\(
								\bm{\Xi}(\mathbf{Q}) \int_0^t e^{- \bm{\Lambda} (t-s)} \bm{\Xi}(\mathbf{Q})^T \mathbf{V}_{ij}(s) \, ds,
								\)
							</li>
						</ul>
						<div class="fragment fade-in-then-semi-out" data-fragment-index="7" style="text-align: left; font-size: 1.2em; margin-top: 10px; margin-bottom: 20px;">
							where \( \bm{\Xi}\) is neural network encode the <b style="color: #E65100;">manybody</b> and \( \bm{\Lambda} \) are learnable parameters encode the <b style="color: #E65100;">Non-Markovian</b>.
						</div>
					</div>
			
				
					<!-- Footer 文献信息：固定在底部，细小不干扰 -->
					<div style="
						position:absolute;
						text-align:left; font-size:0.8em; opacity:0.8;">
						<div><b>Liyao Lyu</b>, Huan Lei<sup>*</sup>.
						Construction of coarse-grained molecular dynamics with many-body non-Markovian memory.
						<em>Physical Review Letters</em>, 2023.
						</div>
					</div>

					<aside class="notes">
						<ul>
							The first ignore the time dependence, the second assume the pair wise, the third combine the pairwise and the time dependece.
							We introduce many-body memory contributions, where the kernel depends on the collective arrangement of particles over time. 
							This kind of contribution is very important to capture the collective behavior of the original atomistic system.
							While our model is more expressive, unrestricted parameterizations risk violating physical laws. To ensure fidelity, we explicitly enforce symmetry constraints
						</ul>
					</aside>
				</section>

				<section data-auto-animate>
					<h3>Important New Issues</h3>
					<div class="two-col-grid">
					<!-- <div class="two-col" style="display: flex; flex-direction: row; align-items: flex-start; gap:16px;"> -->
					<!-- <div class="two-col" style="display: flex; flex-direction: center; align-items: center; gap:16px;"> -->
						<div id="symmetry-text">
							<ul>
								<li>
									<p class="fragment fade" data-fragment-index="1">
										To accurately model many-body dynamics, our neural network must respect <b>physical symmetries</b>:
									</p>
									<ol>
										<li class="fragment fade-in-then-semi-out" data-fragment-index="2">
											Translation Invariance:\(\mathbf{\Xi}(\bQ_1 +\mathbf{b},\cdots,\bQ_M +\mathbf{b}) = \mathbf{\Xi}(\bQ_1,\cdots,\bQ_M)\)<br>
										</li>
										<li class="fragment fade-in-then-semi-out" data-fragment-index="3">
											Rotation Symmetry:  \(\mathbf{\Xi}_{ij}(\mathrm{U}\bQ_1,\cdots,\mathrm{U}\bQ_M) = \mathrm{U}\mathbf{\Xi}_{ij}(\bQ_1,\cdots,\bQ_M)\mathrm{U}^T\)<br>
										</li>
										<li class="fragment fade-in-then-semi-out" data-fragment-index="4">
											Permutation  Symmetries: \(\mathbf{\Xi}_{ij}(\bQ_{\sigma(1)},\cdots,\bQ_{\sigma(M)}) = \mathbf{\Xi}_{\sigma(i)\sigma(j)}(\bQ_1,\cdots,\bQ_M)\)
										</li>
									</ol>
								</li>
								<li class="fragment fade-in-then-semi-out" data-fragment-index="6"> Extensive 
								</li>
							</ul>
						</div>
						<div id="symmetry-demo"
						class="fragment fade-in-then-out" data-fragment-index="5" style="display: flex; justify-content: space-around; margin-left:10px; text-align:center;">
							<div>
								<svg id="canvas1"></svg>
								<p style="font-size: 40px; height:1; margin: 0 0;text-align:center">\(\mathbf{\Xi}\)(<span id="input11"></span> , <span id="input12"></span> , <span id="input13"></span>)</p>
								<div class="matrix">
								<table style="font-size: 40px;">
									<tr>
										<td>&Xi;<span id="gamma111"><sub>1</sub></span><span id="gamma112"><sub>1</sub></span></td>
										<td>&Xi;<span id="gamma113"><sub>1</sub></span><span id="gamma121"><sub>2</sub></span></td>
										<td>&Xi;<span id="gamma114"><sub>1</sub></span><span id="gamma131"><sub>3</sub></span></td>
									</tr>
									<tr>
										<td>&Xi;<span id="gamma122"><sub>2</sub></span><span id="gamma115"><sub>1</sub></span></td>
										<td>&Xi;<span id="gamma123"><sub>2</sub></span><span id="gamma125"><sub>2</sub></span></td>
										<td>&Xi;<span id="gamma124"><sub>2</sub></span><span id="gamma132"><sub>3</sub></span></td>
									</tr>
									<tr>
										<td>&Xi;<span id="gamma133"><sub>3</sub></span><span id="gamma116"><sub>1</sub></span></td>
										<td>&Xi;<span id="gamma134"><sub>3</sub></span><span id="gamma126"><sub>2</sub></span></td>
										<td>&Xi;<span id="gamma135"><sub>3</sub></span><span id="gamma136"><sub>3</sub></span></td>
									</tr>
									<tr>
									</tr>
								</table>
							</div>
								<button id="clearButton1">Clear</button>
							</div>
							<div>
							<svg id="canvas2"></svg>
							<p style="font-size: 40px; height:1; margin: 0 0; text-align:center">\(\mathbf{\Xi}\)(<span id="input21"></span> , <span id="input22"></span> , <span id="input23"></span>)</p>
							<div class="matrix">
								<table style="font-size: 40px;">
									<tr>
										<td>&Xi;<span id="gamma211"><sub>1</sub></span><span id="gamma212"><sub>1</sub></span></td>
										<td>&Xi;<span id="gamma213"><sub>1</sub></span><span id="gamma221"><sub>2</sub></span></td>
										<td>&Xi;<span id="gamma214"><sub>1</sub></span><span id="gamma231"><sub>3</sub></span></td>
									</tr>
									<tr>
										<td>&Xi;<span id="gamma222"><sub>2</sub></span><span id="gamma215"><sub>1</sub></span></td>
										<td>&Xi;<span id="gamma223"><sub>2</sub></span><span id="gamma225"><sub>2</sub></span></td>
										<td>&Xi;<span id="gamma224"><sub>2</sub></span><span id="gamma232"><sub>3</sub></span></td>
									</tr>
									<tr>
										<td>&Xi;<span id="gamma233"><sub>3</sub></span><span id="gamma216"><sub>1</sub></span></td>
										<td>&Xi;<span id="gamma234"><sub>3</sub></span><span id="gamma226"><sub>2</sub></span></td>
										<td>&Xi;<span id="gamma235"><sub>3</sub></span><span id="gamma236"><sub>3</sub></span></td>
									</tr>
									<tr>
									</tr>
								</table>
							</div>
							<button id="clearButton2">Clear</button>
							</div>
							<script src="./figure/permutation.js"></script>
						</div>
					</div>
					<style>
						/* 容器：用 Grid + 变量控制两列比例；禁止溢出 */
						.two-col-grid {
							display: grid;
							grid-template-columns: var(--left, 0.52fr) var(--right, 0.48fr);
							align-items: start;
							gap: 16px;
							overflow: hidden;
						}
						/* 避免列内内容因长行把列撑爆 */
						.two-col-grid > #symmetry-text,
						.two-col-grid > #symmetry-demo {
							min-width: 0;
						}

						/* 平滑动画（对列宽/字体/盒阴影） */
						.two-col-grid,
						#symmetry-text, #symmetry-demo,
						#symmetry-demo svg, #symmetry-demo table {
							transition: grid-template-columns 420ms ease, font-size 420ms ease, box-shadow 420ms ease, filter 420ms ease, max-width 420ms ease, width 420ms ease;
						}

						/* 默认尺寸（第5步未显示时） */
						#symmetry-text { font-size: 1.0em; }
						#symmetry-demo { font-size: 1.0em; }

						/* 右侧图文在容器内响应式：不使用 transform，占位随列宽变化 */
						#symmetry-demo svg { width: 100%; height: auto; max-width: 280px; }
						#symmetry-demo table { width: 100%; max-width: 520px; }

						/* 关键：当第5步 fragment（#symmetry-demo）可见时，动态调整列宽与字体 */
						section:has(#symmetry-demo.current-fragment) .two-col-grid {
							--left: 0.34fr;   /* 左列变窄 */
							--right: 0.66fr;  /* 右列变宽 */
						}
						section:has(#symmetry-demo.current-fragment) #symmetry-text {
							font-size: 0.92em;  /* 左列文字略小，真实占位变小 */
							opacity: 0.65;
						}
						section:has(#symmetry-demo.current-fragment) #symmetry-demo {
							font-size: 1.10em;  /* 右列文字/MathJax/表格真实变大 */
							box-shadow: 0 8px 28px rgba(0,0,0,0.18);
							filter: saturate(1.05);
						}
						section:has(#symmetry-demo.current-fragment) #symmetry-demo svg {
							max-width: 360px;   /* 右侧 SVG 允许更大，但仍受列宽限制 */
						}
						section:has(#symmetry-demo.current-fragment) #symmetry-demo table {
							max-width: 640px;   /* 表格也更宽 */
						}

						/* 小屏保守些，避免溢出 */
						@media (max-width: 1100px) {
							section:has(#symmetry-demo.current-fragment) .two-col-grid { --left: 0.40fr; --right: 0.60fr; }
							section:has(#symmetry-demo.current-fragment) #symmetry-demo svg { max-width: 320px; }
						}
					</style>

						

					<aside class="notes">
						<ul>
						For example, the transition invariant, if we add a vector to each position, which means the all molecular translate a vector b, 
						the memory kernel should not changed.
						Also, if we multiply a unity matrix on each position, which means rotate the molecular, the memory kernel should rotate accordingly.
						and we need to consider the permutation symmetry.
						we also need extensive,
						if we learn a model for a small system in perdicaly boundary condition, we want our  model can be directly applied to a larger system with the same density in perdicaly boundary condition.
					It can enable us to simulate some phenome that not affortable in the atomistic scale	
					</ul>
					</aside>
				</section>
				<section data-auto-animate>
				<h3>Neural Network Representation</h3>

				<!-- 顶部方程 -->
				<div style="text-align:left; margin-bottom: 0.0em;" class="tight-math">
					<b style="color:#E65100;">🚀 Non-Markovian Manybody (Our Model)</b>
					\[
					\dot{\mathbf{P}} = \mathbf{F}^C - \bm{\Xi}(\mathbf{Q}) \int_0^t e^{- \bm{\Lambda} (t-s)} 
					\bm{\Xi}(\mathbf{Q})^T \mathbf{V}_{ij}(s) \, ds + \mathbf{R}(t),
					\]
				</div>

				<!-- Grid 布局 -->
				<div class="nn-grid">
					<!-- 左栏：文字 -->
					<div>
						<ul>
							<li class="fragment fade-in;tight-math" data-fragment-index="2">
							Introducing coordinate feature \(\hat{\mathbf Q}^k_i\):
							\(
							\hat{ \mathbf Q}^k_i = \mathbf{Q}_i \oplus \sum_{l\in\mathcal{N}_i} 
							f^k(|\mathbf{Q}_{il}|)\,\mathbf{Q}_{il} 
							\) 
							</li>
							<li class="fragment fade-in" data-fragment-index="3">
							Compute the distance on the feature:
							\( \hat{\mathbf{Q}}_{ij}^{k} = \hat{\mathbf{Q}}_i^{k} - \hat{\mathbf{Q}}_j^{k} \)
							</li>
							<li class="fragment fade-in" data-fragment-index="4">
							Construct the state dependent part of the memory kernel:
							\(
							\boldsymbol{\Xi}^n_{ij} = \sum_{k=1}^K h_{n,k}(\hat{ \mathbf Q}_{ij}^T \hat{ \mathbf Q}_{ij}) 
							\hat{ \mathbf Q}_{ij}^k \otimes \hat{ \mathbf Q}_{ij}^k
							\)
							</li>
							<!-- <li class="fragment fade-in" data-fragment-index="5">
							\(\bm{\Lambda} =  \bm{S} \bm{S}^T + \bm{A}\),  
							where \(\bm{S}\) is symmetric and \(\bm{A}\) is anti-symmetric.
							</li>
							<li class="fragment fade-in" data-fragment-index="6">
							<div class="highlight">
								The construction satisfies the <span style="color:#E65100">symmetry constraint</span>.
							</div>
							</li> --> 
						</ul>
					</div>
					<div id="nn-figs" class="nn-figstack" style="text-align: center;">
						<figure class="fragment fade-in-then-out" data-fragment-index="2">
						<img src="./figure/Q.png" class="nn-img">
						</figure>
						<figure class="fragment fade-in" data-fragment-index="3">
						<img src="./figure/hatQ.png" class="nn-img">
						</figure>
					</div>
					<style>
						/* 两列：左40% 右60% */
						.nn-grid {
						display: grid;
						grid-template-columns: 60% 40%;
						gap: 20px;
						align-items: start;
						min-height: 60vh;
						}
						/* 当 slide 有 .focus-left 类时：文字占满，图列宽度归零 */
						section.focus-left .nn-grid {
						grid-template-columns: 100% 0%;
						}
						section.focus-left #nn-figs {
						display: none; /* 完全隐藏图区域 */
						}
						.nn-grid > div { min-width: 0; }
						/* 右栏容器：给足高度，居中显示，防溢出 */
						.nn-figstack {
						min-height: 60vh;      /* 可调 55–70vh */
						display: flex;
						align-items: center;
						justify-content: center;
						overflow: hidden;
						}
						/* 缺省不显示；当 fragment 处于当前步或可见时显示 */
						.nn-figstack figure {
						display: none;
						margin: 0;
						max-width: 100%;
						max-height: 100%;
						}
						.nn-figstack figure.visible,
						.nn-figstack figure.current-fragment {
						display: flex;          /* 显示当前这张图 */
						align-items: center;
						justify-content: center;
						}

						/* 图像自适应容器 */
						.nn-img {
						display: block;
						max-width: 100%;
						max-height: 100%;
						border-radius: 8px;
						box-shadow: 0 4px 18px rgba(0,0,0,0.25);
						}

						@media (max-width: 1100px) {
						.nn-grid { grid-template-columns: 45% 55%; }
						}
					</style>
					<script>
					(function () {
					Reveal.on('fragmentshown', e => {
						if (e.fragment && e.fragment.getAttribute('data-fragment-index') === '3') {
						// 第4步之后，准备下一步图消失 → 左边扩展
						const sec = Reveal.getCurrentSlide();
						sec.classList.add('focus-left');
						}
					});
					Reveal.on('fragmenthidden', e => {
						if (e.fragment && e.fragment.getAttribute('data-fragment-index') === '3') {
						// 回退时恢复
						const sec = Reveal.getCurrentSlide();
						sec.classList.remove('focus-left');
						}
					});
					})();
					</script>
				<aside class="notes">
					<ul>
					<li>Introduce \(\hat Q\) features from local neighbor info \(Q_{il}\).</li>
					<li>These inherit symmetry by construction.</li>
					<li>Then compute feature distances and build state-dependent kernels.</li>
					<li>We can prove the symmetry constraints hold.</li>
					</ul>
				</aside>
				</section>

				<section data-auto-animate>
					<h3>
						Simulation of the Coarse-Grained Models
					</h3>
					<div style="text-align: left;">
						<b style="color: #E65100;">🚀 Non-Markovian Manybody (Our Model)</b>
						<p class="tight-math" style="margin-top: 0.5em; text-align: center;">
							\(
							\dot{\mathbf{P}} = \mathbf{F}^C - \bm{\Xi}(\mathbf{Q}) \int_0^t e^{- \bm{\Lambda} (t-s)} \bm{\Xi}(\mathbf{Q})^T \mathbf{V}_{ij}(s) \, ds + \mathbf{R}(t),
							\)
						</p>
					</div>
					<div  style="text-align: left;">
						<ul>
							<li class="fragment fade-in" data-fragment-index="1">
								The construction easy to do simulation.
								\[
								\begin{aligned}
								\dot{\mb Q} &= \mb M^{-1}\mb P \\
								\dot{\mb P} &= -\nabla U(\mb Q) + \bm \Xi(\mb Q)\bm\zeta \\
								\dot{\bm\zeta} &= - \bm \Xi(\mb Q)^T \mb V - \bm\Lambda \bm\zeta + \bm \xi(t). 
								\end{aligned}
								\]
							</li>
							</li>
						</ul>
						<div class="highlight fragment fade-in" data-fragment-index="2">
							<h4 style="color: #E65100; margin-bottom: 5px;">🔑  Thermodynamic Consistency</h4>
							By choosing the white noise \(\bm\xi(t)\) following
								\(
								\left\langle  \bm \xi(t) \bm \xi(t') \right\rangle = \beta^{-1}(\bm\Lambda + \bm\Lambda^T) \delta(t-t'),
								\)
								model  retains the consistent invariant distribution 
								\(
								\rho_{\rm eq}(\mb Q, \mb P, \bm\xi) \propto \exp[{-\beta(U(\mb Q) + \mb P^T \mb M^{-1} \mb P/2 + \bm \zeta^T \bm\zeta/2})]
								\)
						</div>
					</div>
					<aside class="notes">
						<ul>
						By this kind to construction, another benefits is that it is easy to do simulation, 
						The stochasitc intrgral-differential equation can be extend to a stochastic differental-only equation.
						An take specific choice of white noise satisfies the second fluctuation dispation theorm, our equailibrium distribution is consistent 
						with bolzman distribution. 
						Also, you can find that the equilibrium disbution is purely determined by the conservative term rather then the memory term we focus here,
						which means our memory term can help capture the dynamic properties of the system but do not distribute the accuracy of the static propreties 
						introduced by the conservative term.
						</ul>
					</aside>
				</section>
				<section data-auto-animate>
					<h3>Data Collection</h3>
						<ul>
							<li class="fragment fade-in" data-fragment-index="1">
								\(
								\mb K(\bm {Q}, t) := \mathcal{P}_{\mb Z}[(
									{\rm e}^{\mathcal{Q}_{\bm Z} \mathcal{L} t} \mathcal{Q}_{\bm
								Z} \mathcal{L}\mb P) (\mathcal{Q}_{\bm Z} \mathcal{L}\mb P)^T],
								\) 
								<ul class="fragment fade-in" data-fragment-index="2" style="list-style: none; padding: 0; display: grid; grid-template-columns: repeat(2, minmax(200px, 550px)); ">
									<li>
										\(
										\mathcal{P}_{\bm Z} f(\mb z) := \mathbb{E}[f(\mb z) \vert \phi(\mb z) = \bm Z ] 
										\)
									</li>
									<li>
										\(\phi\) maps the full variable \(\mb z\) to the CG variable \(\mb Z\).
									</li>
									<li>
										\(\mathcal{Q}_{\bm Z} = \mb I - \mathcal{P}_{\bm Z}\)
									</li>	
									<li>
										\(\mathcal{L}\)	 is the Liouvillian operator
									</li>
								</ul>
							</li>
							<!-- <li class="fragment fade-in" data-fragment-index="3">
								<div class="highlight">
									The projection operator \(\mathcal{P}_{\bm Z}\) is defined as a conditional expectation, depends on conditional probability distribution.
								</div>
							</li> -->
							<li class="fragment fade-in" data-fragment-index="3">
								<div class="highlight">
									The orthogonal dynamics <span style="color: #E65100;">\({\rm e}^{\mathcal{Q}_{\bm Z} \mathcal{L} t}\) </span>is computationally intractable.
								</div>
							</li>
							<li class="fragment fade-in" data-fragment-index="4">
								Approximate <span style="color: #E65100;">\(\mathcal{Q}_{\bm Z} \mathcal{L} \) </span> by restrained dynamics <span style="color: #E65100;"> \(\mathcal{R}_{\bm Z} \mathcal{L} \)</span>:
								<!-- The dynamics of the restrained system is given by: \(\dot{\mb z} = \mathcal{R}_{\bm Z} \mathcal{L} \mb z  \) -->
								<p class="tight-math" style="margin:0.5em; text-align:center;">
									\(
								\dot{\mb q}_\mu = \mathcal{R}_{\bm Z} \mathcal{L} \mb q_\mu :=  \frac{\mb p_\mu}{m_\mu} -  \frac{\mb P_i}{M_i} \qquad
								\dot{\mb p}_\mu = \mathcal{R}_{\bm Z} \mathcal{L} \mb p_\mu :=  \mb f_\mu - \frac{m_\mu}{M_i} F_i
								\)
								</p>
							</li>
							<li class="fragment fade-in" data-fragment-index="5">
								The memory kernel is approximated as:
								<p class="tight-math" style="margin:0.5em; text-align:center;">
								\(
									\mb K_{\text{MZ}}(\bm {Q} , t) = \left \langle  \delta \mb F(t) \delta \mb F(0)^T\right\rangle,
								\)
								</p>
								where \(\delta \mb F = \mb F - \mathcal{P}_{\bm Z }(\mb F)\) represents the fluctuation force.
							</li>
						</ul>
					<aside class="notes">
						<ul>
						Before, we go to the numerical part, we also want the briefly talk about how we collect the data.
						As we said before, MZ told us that the kernel takes this form where operator P_Z and Q_Z are projections,
						defined by a marginal distribution and L is the liouviall operator. 
						However, the orthogonal dynamics \({\rm e}^{\mathcal{Q}_{\bm Z} \mathcal{L} t}\) is computationally intractable.
						Instead, we introduce an restrained dynamics to replace it and the memory kernel can be approximated by from the simulation.
						</ul>
					</aside>
				</section>
				<section data-auto-animate data-menu-title="VACF">
					<h3>
						Numerical Result
					</h3>
					<div style="display: flex; justify-content: center; align-items: center;" class="fragment fade-in-then-out">
						<div style="text-align:left">
								Velocity auto correlation function (VACF)
							<p style=" font-size:0.8em">
									\[ c(t)=\frac{\lt V_i(t) \cdot V_i(0) \gt }{ \lt V_i(0) \cdot V_i(0) \gt } \]
							</p>
							<div style="text-align:left; font-size:0.8em" data-id="table">
								<table border="1">
									<tr>
										<th>Model</th>
										<th>Temporal</th>
										<th>Spatial</th>
									</tr>
									<tr>
										<td style="white-space: nowrap;">M-DPD</td>
										<td>Markovian</td>
										<td>Pairwise</td>
									</tr>
									<tr>
										<td style="white-space: nowrap;">NM-GLE</td>
										<td style="white-space: nowrap;">Non-Markovian</td>
										<td>Isotropic</td>

									</tr>
									<tr>
										<td style="white-space: nowrap;">NM-DPD</td>
										<td style="white-space: nowrap;">Non-Markovian</td>
										<td>Pairwise</td>
									</tr>
									<tr>
										<td style="color:#E65100; white-space: nowrap;">NM-MB</td>
										<td style="white-space: nowrap;">Non-Markovian</td>
										<td>Manybody</td>
									</tr>
								</table>
							</div>
						</div>
						<div
							id=vacf
							class="plotly-graph-div"
							style="height:450; width:450;">
						</div>
						<script type="text/javascript" src="./text/vacf.js">
						</script>
					</div>
					<aside class="notes">
						<!-- Next, we’re exploring isotropic dynamic properties, such as the Velocity Auto Correlation Function (VACF), which measures the time correlation of a particle's velocity. Notice how our model, marked as NM-MB (red), and the state-independent GLE (purple) are spot on! This is because the GLE model uses the memory kernel as a free parameter to fit the VACF. As Von Neumann said, with four free parameters, one can draw an elephant! It’s not surprising, but it doesn’t mean GLE can recover the dynamics accurately. -->
						</aside>
					</section>
					<section data-auto-animate data-menu-title="VCCF">
						<h3>
							Numerical Result
						</h3>
						<div style="display: flex; justify-content: center; align-items: center;">
							<div style="text-align:left;">
									Velocity cross correlation function (VCCF)
								<p style=" font-size:0.8em">
									\[ C^{xx}(t; r_0) = \mathbb{E}[\mathbf{V}_i(0)\cdot\mathbf{V}_j(t) \vert Q_{ij}(0) = r_0] \]
								</p>
								<div style="font-size: 0.8em;" data-id="table">
									<table border="1">
										<tr>
											<th>Model</th>
											<th>Temporal</th>
											<th>Spatial</th>
										</tr>
										<tr>
											<td style="white-space: nowrap;">M-DPD</td>
											<td>Markovian</td>
											<td>Pairwise</td>
										</tr>
										<tr>
											<td style="white-space: nowrap;">NM-GLE</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Isotropic</td>
	
										</tr>
										<tr>
											<td style="white-space: nowrap;">NM-DPD</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Pairwise</td>
										</tr>
										<tr>
											<td style="color:#E65100; white-space: nowrap;">NM-MB</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Manybody</td>
										</tr>
									</table>
								</div>
							</div>
							<div
								id=vccf
								class="plotly-graph-div"
								style="height:400; width:400;">
							</div>
							<script type="text/javascript" src="./text/vccf.js">
							</script>
						</div>
						<aside class="notes">
							<!-- If we delve deeper into metrics like the Velocity Cross Correlation Function (VCCF), which represents the momentum transfer rate at a fixed distance, we see that GLE falls short, but our model still captures the main contribution. It’s also worth noting that NM-DPD shows decent results, but that’s because it uses VCCF as a fitting target. -->
							</aside>
					</section>
					<section data-auto-animate data-menu-title="VHF">
						<h3>
							Numerical Result
						</h3>
						<div style="display: flex; justify-content: center; align-items: center;">
							<div style="text-align:left">
								van Hove function (VHF)
								<p style="font-size: 0.8em;">
									\( G(r, t) \propto \frac{1}{M^2} \sum_{j\neq i}^M \delta(\Vert \mathbf{Q}_i(t) - \mathbf{Q}_j(0)\Vert - r) \).		
								</p>
								<div style="font-size: 0.8em;" data-id="table">
									<table border="1">
										<tr>
											<th>Model</th>
											<th>Temporal</th>
											<th>Spatial</th>
										</tr>
										<tr>
											<td style="white-space: nowrap;">M-DPD</td>
											<td>Markovian</td>
											<td>Pairwise</td>
										</tr>
										<tr>
											<td style="white-space: nowrap;">NM-GLE</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Isotropic</td>
	
										</tr>
										<tr>
											<td style="white-space: nowrap;">NM-DPD</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Pairwise</td>
										</tr>
										<tr>
											<td style="color:#E65100; white-space: nowrap;">NM-MB</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Manybody</td>
										</tr>
									</table>
								</div>
							</div>
							<div
								id=vhf
								class="plotly-graph-div"
								style="height:400; width:400;">
							</div>
							<script type="text/javascript" src="./text/vhf.js">
							</script>
						</div>
						<aside class="notes">
							<!-- Let’s look at another property, the van Hove Function (VHF), which is essentially a time evolution of the RDF. It measures the probability of finding a particle at time t with distance r from the central particle. Here, both NM-DPD and NM-GLE fall short, but our model stands strong! -->
							</aside>
					</section>
					<section data-auto-animate data-menu-title="Hydromode">
						<h3>
							Numerical Result
						</h3>
						<div style="display: flex; justify-content: center; align-items: center;">
							<div style="text-align:left">
									normalized correlations of the <br> <b>Longitudinal</b> Hydrodynamic Modes
								<p style=" font-size:0.8em">
									\[ 
									\begin{split}
									C_L(t) &= \langle \tilde{u}_1(t)\tilde{u}_1(0)\rangle \\
									\tilde{\mb u} &= \frac{1}{M}\sum_{j=1}^M \mb V_j {\rm e}^{i\mb k \cdot \mb Q_j}
									\end{split}
									\]
								</p>
								<div style="font-size: 0.8em;" data-id="table">
									<table border="1">
										<tr>
											<th>Model</th>
											<th>Temporal</th>
											<th>Spatial</th>
										</tr>
										<tr>
											<td style="white-space: nowrap;">M-DPD</td>
											<td>Markovian</td>
											<td>Pairwise</td>
										</tr>
										<tr>
											<td style="white-space: nowrap;">NM-GLE</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Isotropic</td>
	
										</tr>
										<tr>
											<td style="white-space: nowrap;">NM-DPD</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Pairwise</td>
										</tr>
										<tr>
											<td style="color:#E65100; white-space: nowrap;">NM-MB</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Manybody</td>
										</tr>
									</table>
								</div>
							</div>
							<div
								id=long_corr
								class="plotly-graph-div"
								style="height:400; width:400;">
							</div>
							<script type="text/javascript" src="./text/long_corr.js">
							</script>
							<aside class="notes">
								We can also explore the correlation of wave propagation modes, which represent the coefficients of the linearized NV equation in the spectrum domain. In the longitudinal direction, both NM-DPD and our model perform well, as the conservative term mainly contributes in this direction.
								</aside>
					</section>
					<section data-auto-animate data-menu-title="Hydromode">
						<h3>
							Numerical Result
						</h3>
						<div style="display: flex; justify-content: center; align-items: center;">
							<div style="text-align:left">
									normalized correlations of the <br> <b>Transverse</b> Hydrodynamic Modes
								</h5>
								<p>
									\[ 
									\begin{split}
									C_T(t) &= \langle \tilde{u}_2(t)\tilde{u}_2(0)\rangle \\
									\tilde{\mb u} &= \frac{1}{M}\sum_{j=1}^M \mb V_j {\rm e}^{i\mb k \cdot \mb Q_j}
									\end{split}
									\]
								</p>
								<div style="font-size: 0.8em;" data-id="table">
									<table border="1">
										<tr>
											<th>Model</th>
											<th>Temporal</th>
											<th>Spatial</th>
										</tr>
										<tr>
											<td style="white-space: nowrap;">M-DPD</td>
											<td>Markovian</td>
											<td>Pairwise</td>
										</tr>
										<tr>
											<td style="white-space: nowrap;">NM-GLE</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Isotropic</td>
	
										</tr>
										<tr>
											<td style="white-space: nowrap;">NM-DPD</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Pairwise</td>
										</tr>
										<tr>
											<td style="color:#E65100; white-space: nowrap;">NM-MB</td>
											<td style="white-space: nowrap;">Non-Markovian</td>
											<td>Manybody</td>
										</tr>
									</table>
								</div>
							</div>
							<div
								id=trans_corr
								class="plotly-graph-div"
								style="height:300; width: 300;">
							</div>
							<script type="text/javascript" src="./text/trans_corr.js">
							</script>
							<aside class="notes">
								However, when it comes to the transverse term, our model clearly outshines the others.
								</aside>
					</section>
					<section data-auto-animate>
						<h3>
							Extension to Nonequilibrium
						</h3>
						<div>
							<ul>
								<li class="fragment fade-in" >
									Predicting <strong>
										non-equilibrium
									</strong> processe, i.e. evolution under an external force field \(V_{\text{ext}}(\bq)\).
								</li>
								<li class="fragment fade-in" >
									For a given configuration \(\bm {Q}\), theoretically:
									<p class="tight-math" style="margin:0.5em; text-align:center;">
									\(
									\mb K(\bm {Q}, t) = \mathcal{P}_{\mb Z}[({\rm e}^{\mathcal{Q}_{\bm Z} \mathcal{L} t}\mathcal{Q}_{\bm Z} \mathcal{L}\mb P) (\mathcal{Q}_{\bm Z} \mathcal{L}\mb P)^T],
									\)
									</p>	
									where the projection operator:
									\(
									\mathcal{P}_{\bm Z} f(\mb z) := \mathbb{E}[f(\mb z) \vert \phi(\mb z) = \bm Z ].
									\)
								</li>
								<li class="fragment fade-in" >
									<div class="highlight">
									The Kernel depends on the conditional probability distribution
									\(
										\rho_{V_{\text{ext}}}(\bz|\bZ) = \frac{1}{Z} \delta(\phi(\bz)-\bZ) \rho_{V_{\text{ext}}}(\bz) 
									\)
									</div>
								</li>
								<li class="fragment fade-in" >
									The Time dependent projection result in <span style="color:#E65100">\(K(\bQ,t,s)\): </span>
									<p class="tight-math" style="margin:0.5em; text-align:center;">
									\(
									\dot{\mathbf{P}}(t) = 
									-F(\mathbf{Q}) 
									- \int_0^t \mathbf{K}(\mathbf{Q}(s), t,s)\,\mathbf{V}(s)\,ds 
									+ \mathbf{R}(t).
									\)
									</p>
									
								</li>
								
							</ul>
						</div>
						<div style="opacity: 0.8; font-size: 0.8em; text-align: left; position: absolute;">
							<div>Hermann Grabert.
								Projection Operator Techniques in Nonequilibrium Statistical Mechanics.
								<em> Springer Tracts in Modern Physics</em>, 1982.
							</div>
						</div>
						<aside class="notes">
							We also want to extend our construction of CGMD model to non-equilibrium case, which means the system is subject to a external force field.
							The difficulty is the memory kernal in Mori-Zwanzig is actually depends on the distribution, but under the external force field the distbribution is actually 
							changing with respect to time. So theorically, memory kernel will depend on time explicitly. However, in partice, since the model is related to the spetific external 
							force field and time, the trained model can only be used to a specific condition and cannot be generalized to other external force field.

							Instead, we define the projection still on the moarginal density of the equilibrum distbribution, but we add more variables to make the marginal distribution to be closer.

							</aside>
					</section>
					<section data-auto-animate>
						<h3>
							Extension to Nonequilibrium
						</h3>
						<div>
							<ul>
								<li >
									Predicting <strong>
										non-equilibrium
									</strong> processe, i.e. evolution under an external force field \(V_{\text{ext}}(\bq)\).
								</li>
								<li >
									For a given configuration \(\bm {Q}\), theoretically:
									<p class="tight-math" style="margin:0.5em; text-align:center;">
									\(
									\mb K(\bm {Q}, t) = \mathcal{P}_{\mb Z}[({\rm e}^{\mathcal{Q}_{\bm Z} \mathcal{L} t}\mathcal{Q}_{\bm Z} \mathcal{L}\mb P) (\mathcal{Q}_{\bm Z} \mathcal{L}\mb P)^T],
									\)
									</p>	
									where the projection operator:
									\(
									\mathcal{P}_{\bm Z} f(\mb z) := \mathbb{E}[f(\mb z) \vert \phi(\mb z) = \bm Z ].
									\)
								</li>
								<li >
									<div class="highlight">
									<strong>Increase the dimension of Coarse grained variables </strong> to make the marginal distribution closer
									<p class="tight-math" style="margin:0.5em; text-align:center;">
										\(
										\rho_{V_{\text{ext}}}(\bz|\bZ) = \frac{1}{Z_{\text{ext}}} \delta(\phi(\bz)-\bZ) \rho_{V_{\text{ext}}}(\bz) \approx
										\frac{1}{Z_0} \delta(\phi(\bz)-\bZ) \rho_{0}(\bz) = \rho_{0}(\bz|\bZ) 
										\)
									</p>	
									</div>
								</li>
								<li class="fragment fade-in" >
									The resultant model can be <strong>generalized</strong> to other external force fields.
									<p class="tight-math" style="margin:0.5em; text-align:center;">
										\(
									\dot{\mathbf{P}}(t) = 
									-F(\mathbf{Q}) 
									- \int_0^t {\mathbf{K}(\mathbf{Q}(s), t-s) }\mathbf{V}(s) ds 
									+ \mathbf{R}(t).
										\)
									</p>	
								</li>
								
							</ul>
						</div>
						<div style="opacity: 0.8; font-size: 0.8em; text-align: left; position: absolute;">
							<div><b>Liyao Lyu</b>, Huan Lei<sup>*</sup>.
							On the Generalization Ability of Coarse-Grained Molecular Dynamics Models for Nonequilibrium Processes.
							<em>Multiscale Modeling & Simulation </em>, 2025.
							</div>
						</div>	
					</section>
					<section>
						<h3>
							Numerical Result:reverse Poiseuille flow
						</h3>
						<div style="display: flex; justify-content: center; align-items: center;">
							<div
								id=velocity_profile
								class="plotly-graph-div"
								style="height:450; width:450;">
							</div>
							<div
								id=shear_rate_vs_viscosity
								class="plotly-graph-div"
								style="height:450; width:450;">
							</div>
							<script type="text/javascript" src="./text/velocity_profile.js">
							</script>
							<script type="text/javascript" src="./text/shear_rate_vs_viscosity.js"></script>
						</div>
					</section>
					<section>
							<h3>
								Numerical Result:Vortex flow
							</h3>
							<div>
								<iframe src="./html/vel_evol.html" width="600" height="500" style="border:none; flex: 1; margin-left: 20px;" loading="lazy"></iframe>
							</div>
						</section>
						<section>
							<h3>
								Summary
							</h3>
							<div style="text-align:left">
								The proposed <b>Non-Markovian Manybody</b> model employs neural networks to encode many-body interactions and learnable parameters to capture non-Markovian memory. 
								<ul>
									<li  class="fragment fade-in">
										<b>Symmetry Enforcement</b>: The neural network architecture explicitly respects translation invariance, rotation symmetry, and permutation symmetries, ensuring physically consistent dynamics.
									</li>
									<li  class="fragment fade-in">
										<b>Thermodynamic Consistency</b>: The model integrates neural networks into the Mori-Zwanzig framework, enabling accurate simulations while retaining thermodynamic consistency.
									</li>
								</ul>
							</div>
						</section>
						<section data-auto-animate>
							<h3>
								Outlook: Macroscopic Model
							</h3>
							In collaboration with Huan Lei
							<div style="display: flex; flex-direction: center; align-items: center;">
								<div>
									<ul>
										<li class="fragment fade-in" data-fragment-index="1">
											Non Fourier heat conduction
											<ul>
												<li class="fragment fade-in" data-fragment-index="2">
													Fourier Law
													<p class="tight-math" style="margin:0.5em; text-align:center;">
														\(
													u_t = \kappa \Delta u
														\)
													</p>
														<span style="color:#E65100;" class="fragment fade-in" data-fragment-index="3"><strong>Limitation:</strong></span>
														<ul>
															<li class="fragment fade-in" data-fragment-index="4">
																Linear Approximation
															</li>
															<li class="fragment fade-in" data-fragment-index="5">
																Temperature cannot close the dynamics by itself<br>
																<div class="fragment fade-in" data-fragment-index="6">
																	<span style="color:#E65100;">Reason:</span> High temperature coexist multiple phases: fcc, bcc, hcp <br>
																</div>
																<div class="fragment fade-in" data-fragment-index="7">
																	<span style="color:#E65100;">Solution:</span> Steinhardt order parameters as phase variables into dynamics.
																</div>
															</li>
														</ul>
												</li>
												<li class="fragment fade-in" data-fragment-index="8">
													Non Fourier Law <br>
													\[
													\left(
													\begin{matrix}
													u_t \\
													v_t 
													\end{matrix}
													\right)
													= \left[
													-\left(
													\begin{matrix}
													0 & 0 \\
													0 & \alpha[u,v]
													\end{matrix}
													\right)
													+  \nabla\cdot\Gamma[u,v] \nabla 
													\right]
													\begin{matrix}
													\frac{\delta\mathcal{S}[u,v] }{\delta u } \\
													\frac{\delta\mathcal{S}[u,v] }{\delta v } 
													\end{matrix}
													\]
												</li>
											</ul>
										</li>
									</ul>
								</div>
						</section>
						<section data-auto-animate>
							<h3>
								Outlook: Macroscopic Model
							</h3>
							In collaboration with Huan Lei
							<div>
								<ul>
									<li>
										Non fourier heat conduction
									<div
										id=38d86c9b-66ba-4c03-a5a1-33a6b0960fff
										class="plotly-graph-div"
										style="height:350; width:450;">
									</div>
									<script type="text/javascript" src="./text/heat_conduction.js"></script>
									</li>
								</ul>
							</div>
							<div class="highlight fragment fade-in">
								<span style="color:#E65100;"><strong>Future Direction:</strong></span><br>
								<ul>
									<li class="fragment fade-in">
										Include the thermal fluctuation at nano-scale
									</li>
									<li class="fragment fade-in">
										Extend to the diffusion process of active matter.
									</li>
								</ul>
							</div>
						</section>
						<section data-menu-title="Adam CBO">
						<div class="cbo-slide">
							<!-- 标题 -->
							<h1 id="title-cbo"></h1>
							<!-- 合作者 -->
							<p id="Cooperator-cbo"></p>
						</div>

						<script>
							function typeText(elementId, text, speed) {
							let i = 0;
							function type() {
								if (i < text.length) {
								document.getElementById(elementId).innerHTML += text.charAt(i);
								i++;
								setTimeout(type, speed);
								}
							}
							type();
							}

							document.addEventListener("DOMContentLoaded", function () {
							typeText(
								"title-cbo",
								"Consensus-based optimization methods with adaptive momentum estimation and its application in Stochastic Control",
								30
							);
							setTimeout(
								() =>
								typeText(
									"Cooperator-cbo",
									"Joint work with Shi Jin (SJTU) and Jingrun Chen (USTC)",
									30
								),
								3500
							);
							});
						</script>

						<style>
							.cbo-slide {
							display: flex;
							flex-direction: column;
							justify-content: center;
							align-items: center;
							height: 80vh; /* 占满页面居中 */
							text-align: center;
							}
							#title-cbo {
							font-size: 2em;
							color: #2c3e50;
							font-weight: 700;
							margin-bottom: 1.5em;
							}
							#Cooperator-cbo {
							font-size: 1.1em;
							font-weight: bold;
							color: #34495e;
							}
						</style>

						</section>

						<section data-auto-animate>
							<h3>
								Stochastic optimal control (SOC)
							</h3>
							<div>
								<br>
								<ul>
									<li class="fragment fade-in">
										Traditional methods: Curse of dimensionality
									</li>
									<li class="fragment fade-in">
										Deep reinforcement learning approaches
									</li>
									<li class="fragment fade-in">
										Model-based methods require explicit transition kernels
									</li>
									<li class="fragment fade-in">
										Model-free methods suffer from high variance in policy
										gradients
									</li>
									<li class="fragment fade-in">
										Our contribution (ICML, 2025)
										<ul>
											<li>
												Gradient-free, model-free algorithm (M-CBO/Adam-CBO)
											</li>
											<li>
												Theoretical convergence guarantees
											</li>
											<li>
												Scalable to high dimensions
											</li>	
										</ul>
									</li>
								</ul>
							</div>
						</section>
						<section data-auto-animate>
						<h3>Problem Formulation</h3>

						<ul style="font-size:1.05em; line-height:1.4;">
							<li  class="fragment fade-in">
							State space: \( \mathcal{S} \subset \mathbb{R}^d \),&nbsp;
							Action space: \( \mathcal{A} \subset \mathbb{R}^m \).
							</li>
							<li  class="fragment fade-in">
							State process \( x_t \) governed by control \( \alpha_t \).
							</li>
							<li class="fragment fade-in;tight-math">
							Cost functional:
							\[
								J[\alpha] \;=\; \mathbb{E}\!\left[\int_{0}^{T} f\!\big(t, x_t, \alpha_t\big)\,dt \;+\; g(x_T)\right].
							\]
							</li>
							<li  class="fragment fade-in">
							Policy parameterized by a neural network:
							\( \alpha(t,x;\theta) \).
							</li>
							<li class="fragment fade-in;tight-math">
							Goal:
							\[
								\min_{\theta}\; J(\theta), 
								\qquad \text{where}\;\; J(\theta)=J\!\big[\alpha(\cdot,\cdot;\theta)\big].
							\]
							</li>
						</ul>
						</section>
						<section data-auto-animate>
						<h3>Original CBO Method</h3>
						<div class="cbo-left">
							<ul>
							<li class="fragment fade-in">
								Highly nonconvex unconstrained optimization problem:
							\[
								\Theta^* \;=\; \arg\min_{\Theta \in \mathbb{R}^d}\; \mathcal{J}(\Theta)
							\]
							</li>
							<li class="fragment fade-in">
								Interacting particles during the dynamic evolution:
								<ul>
								<li class="fragment fade-in">tend to their weighted average</li>
								<li class="fragment fade-in">undergo fluctuation due to random noise</li>
								</ul>
							</li>
							<li class="fragment fade-in">
								\(N\) particles \( \Theta^i, \; i=1,\cdots,N \)
								\[
								d\Theta^i_t
								= -\lambda\!\left(\Theta^i - \mathcal{M}_\beta(\boldsymbol{\Theta})\right) dt
								+ \sigma \,\color{red}{\left|\Theta^i - \mathcal{M}_\beta(\boldsymbol{\Theta})\right|}\, dW^i_t
								\]
							where
								weighted average: \(
								\mathcal{M}_\beta(\boldsymbol{\Theta})
								= \frac{\sum_{i=1}^N \Theta^i \, e^{-\beta \mathcal{J}(\Theta^i)}}
									{\sum_{i=1}^N e^{-\beta \mathcal{J}(\Theta^i)}}
								\)
							</li>
							</ul>
						</div>
						</section>
						<section data-auto-animate>
						<h3>Some Practical Issues in CBO</h3>
						<div class="cbo-left">
							<ul>
							<li class="fragment fade-in">
								<span style="color:red;">The initial data need to be well-chosen</span>
							</li>
							<li class="fragment fade-in">
								Difficult to optimize high-dimensional non-convex functions  
								(e.g. Rastrigin function in dimension \(20\))
							</li>
							<li class="fragment fade-in">
								Difficult to optimize deep neural networks with many parameters
							</li>
							</ul>
						</div>
						</section>
						<section data-auto-animate>
						<h3>First-order Momentum</h3>
						<div class="cbo-left">
							<ul>
							<li class="fragment fade-in">
								The same system without the random term but with inertia effect  
								<span style="font-size:0.8em;">[Chen et al., 2022]</span>
								\[
								\gamma \ddot{\Theta}^i_t + \dot{\Theta}^i_t 
								= -\lambda \left(\Theta_t^i- \mathcal{M}_\beta(\boldsymbol{\Theta})\right), 
								\quad i=1,\cdots,N
								\]
							</li>

							<li class="fragment fade-in">
								An equivalent first-order system:
								\[
								\dot \Theta_t^i = \tfrac{1}{\lambda}\Omega_t^i, 
								\quad
								\gamma \dot \Omega_t^i + \Omega_t^i 
								= -\left(\Theta_t^i - \mathcal{M}_\beta(\boldsymbol{\Theta})\right)
								\]
							</li>

							<li class="fragment fade-in">
								Reformulation and add the stochastic term:
								\[
								\begin{aligned}
								d \Theta^i_t &= \lambda \Omega^i_{t-1}\,dt 
								+ \sigma(t)\, dW^i_{\theta,t}, \\
								d \Omega^i_t &= -\gamma \Omega^i_{t-1}\,dt 
								- m\!\left(\Theta_t^i - \mathcal{M}_\beta(\boldsymbol{\Theta})\right)\!dt 
								+ \sqrt{m}\,\sigma(t)\, dW^i_{\omega,t}
								\end{aligned}
								\]
							</li>
							</ul>
						</div>
						</section>
						<section data-auto-animate>
						<h3>Momentum Consensus-Based Optimization (M-CBO)</h3>
						<div class="cbo-left">
							<ul>
							<li class="fragment fade-in">
								Initialize population of \(N\) particles and momentum \((\boldsymbol{\Theta},\boldsymbol{\Omega})\).
							</li>

							<li class="fragment fade-in">
								Consensus point:
								\[
								\mathcal{M}_{\beta}(\boldsymbol{\Theta})
								= \frac{\sum_{i=1}^N \Theta^i \, w_\beta(\Theta^i)}
									{\sum_{j=1}^N w_\beta(\Theta^j)}, 
								\quad
								w_\beta(\Theta) = e^{-\beta \mathcal{J}(\Theta)}
								\]
							</li>

							<li class="fragment fade-in">
								Dynamics:
								\[
								\begin{aligned}
								d\Theta^i_t &= \Omega^i_t\,dt 
								- \gamma_1\!\left(\Theta^i_t - \mathcal{M}_\beta(\boldsymbol{\Theta})\right)dt
								+ \sigma(t)\,dW^i_{\theta,t}, \\
								d\Omega^i_t &= -m\!\left(\Theta^i_t - \mathcal{M}_\beta(\boldsymbol{\Theta})\right)dt 
								- \gamma_2\Omega^i_t\,dt 
								+ \sqrt{m}\,\sigma(t)\,dW^i_{\omega,t}
								\end{aligned}
								\]
							</li>
							</ul>
						</div>
						</section>
						<section data-auto-animate>
						<h3>Adaptive Momentum CBO (Adam-CBO)</h3>
						<div class="cbo-left">
							<ul>
							<li class="fragment fade-in">
								Replace constant \(m\) with adaptive term:
								\[
								(V_\beta[\boldsymbol{\Theta}] + \epsilon I)^{-1}
								\]
								where
								\[
								V_\beta[\boldsymbol{\Theta}]
								= \frac{\sum_{i=1}^N 
								(\Theta^i - \mathcal{M}_\beta[\boldsymbol{\Theta}])^2 w_\beta(\Theta^i)}
								{\sum_{j=1}^N w_\beta(\Theta^j)}
								\]
							</li>

							<li class="fragment fade-in">
								Similar to Adam optimizer → better convergence.
							</li>

							<li class="fragment fade-in">
								Algorithm details:
								<ul>
								<li class="fragment fade-in">Batch updates of agents</li>
								<li class="fragment fade-in">Adaptive exploration strength</li>
								</ul>
							</li>
							</ul>
						</div>
						</section>
						<section data-auto-animate>
						<h3>Theoretical Guarantees</h3>
						<div class="cbo-left">
							<p class="fragment fade-in"><b>Theorem (Convergence)</b></p>
							<ul>
							<li class="fragment fade-in">
								Under assumptions on cost \(\mathcal{J}\) and parameters:
								<ul>
								<li class="fragment fade-in">M-CBO converges to optimal policy.</li>
								<li class="fragment fade-in">
									Exponential decay of energy functional:
									\[
									E[\rho_t] \leq E[\rho_0]\,e^{-(1-\tau)\lambda t},
									\quad
									E[\rho] = \tfrac{1}{2}\!\int \|\theta-\tilde{\theta}\|^2 + m^{-1}\|\omega\|^2\,d\rho
									\]
								</li>
								</ul>
							</li>
							<li class="fragment fade-in">
								Key properties:
								<ul>
								<li class="fragment fade-in">Well-posedness of M-CBO dynamics</li>
								<li class="fragment fade-in">Mean-field limit analysis</li>
								</ul>
							</li>
							</ul>
						</div>
						</section>

						<section data-auto-animate>
						<h3>Assumptions on Cost Function \(\mathcal{J}\)</h3>
						<div class="cbo-left">
							<ul>
							<li class="fragment fade-in">
								There exists \(\tilde\theta\) such that  
								\(\mathcal{J}(\tilde\theta) = \inf_\theta \mathcal{J}(\theta) =: \underline{J}\).  
								Also bounded: \(\sup \mathcal{J} \leq \overline{J}\).
							</li>
							<li class="fragment fade-in">
								Locally Lipschitz continuous:  
								\(\|\mathcal J[\theta_1]-\mathcal J[\theta_2]\| 
								\leq L_J (\|\theta_1\|+\|\theta_2\|)\|\theta_1-\theta_2\|\).
							</li>
							<li class="fragment fade-in">
								Growth condition:  
								\(\mathcal J(\theta) - \underline{J} \leq c_{\mathcal J}(1+\|\theta\|^2)\).
							</li>
							<li class="fragment fade-in">
								There exist \(\delta_J,R_0,\eta,\mu >0\) such that  
								\[
								\|\theta - \tilde\theta\| \leq 
								\tfrac{(\mathcal{J}(\theta) -\underline{ J})^\mu}{\eta}
								\quad \text{for all } \theta \in B_{R_0}(\tilde\theta),
								\]
								and outside the ball,  
								\(\mathcal J(\theta) - \underline{ J } > \delta_J\).
							</li>
							<li class="fragment fade-in">
								Noise strength \(\sigma(t)\) bounded:  
								\(\underline{\sigma} \leq \sigma(t) \leq \overline{\sigma}\).
							</li>
							</ul>
						</div>
						</section>
						<section data-auto-animate>
						<h3>Rastrigin Function</h3>
						<div class="cbo-left">
							<div class="fragment fade-in" data-fragment-index="1">
							\[
							f(x) = \frac{1}{d}\sum_{i=1}^d \Big[(x_i - B)^2 - 10\cos\big(2\pi(x_i - B)\big) + 10\Big] + C
							\]
							with \(B = \arg\min f(x)\) and \(C = \min f(x)\).
							</div>
							<div style="text-align:center;">
							<figure class="fragment fade-in" data-fragment-index="2" style="margin-top:0.8em;">
							<img src="figure/R_function.png" alt="Rastrigin 2D" style="max-width:60%; ">
							<figcaption style="margin-top:.3em;">\(d=2\) and \(B=C=0\)</figcaption>
							</figure>
							</div>
							
						</div>

						<style>
							.cbo-left { text-align:left; }
							mjx-container[jax="CHTML"][display="true"] { margin: .45em 0 !important; }
						</style>
						</section>
						<section data-auto-animate>
						<h3>Comparison with Different Random Processes</h3>
						<div class="cbo-left">
							<p class="fragment fade-in" data-fragment-index="1"><b>CBO</b></p>
							<div class="fragment fade-in" data-fragment-index="2" style="overflow-x:auto;">
							<table class="tbl">
								<thead>
								<tr>
									<th>d</th><th>N</th><th>M</th><th>\(\mathcal{N}(0,1)\)</th><th>\(\mathcal{U}(-1,1)\)</th>
								</tr>
								</thead>
								<tbody>
								<tr><td>2</td><td>50</td><td>40</td><td>100%</td><td>100%</td></tr>
								<tr><td>10</td><td>50</td><td>40</td><td>100%</td><td>100%</td></tr>
								<tr><td>20</td><td>50</td><td>40</td><td>98%</td><td>22%</td></tr>
								<tr><td>20</td><td>50</td><td>20</td><td>66%</td><td>2%</td></tr>
								<tr><td>30</td><td>50</td><td>40</td><td>26%</td><td>0%</td></tr>
								<tr><td>30</td><td>500</td><td>5</td><td>0%</td><td>0%</td></tr>
								</tbody>
							</table>
							</div>

							<p class="fragment fade-in" data-fragment-index="3" style="margin-top:1em;"><b>Adam-CBO</b></p>
							<div class="fragment fade-in" data-fragment-index="4" style="overflow-x:auto;">
							<table class="tbl">
								<thead>
								<tr>
									<th>d</th><th>N</th><th>M</th><th>\(\mathcal{N}(0,1)\)</th><th>\(\mathcal{U}(-1,1)\)</th>
								</tr>
								</thead>
								<tbody>
								<tr><td>30</td><td>500</td><td>5</td><td>99%</td><td>100%</td></tr>
								<tr><td>100</td><td>5000</td><td>5</td><td>100%</td><td>100%</td></tr>
								<tr><td>1000</td><td>8000</td><td>50</td><td>92%</td><td>20%</td></tr>
								</tbody>
							</table>
							</div>
						</div>

						<style>
							.tbl { border-collapse:collapse; font-size:.95em; }
							.tbl th, .tbl td { border:1px solid #bbb; padding:.35em .6em; text-align:center; }
							.tbl thead th { background:#f2f2f2; }
						</style>
						</section>
						<section data-auto-animate>
						<h3>Linear-Quadratic-Gaussian Control</h3>
						<div class="cbo-left">
							<figure class="fragment fade-in">
							<img src="figure/value_function_case2.png" alt="LQG value" style="max-width:80%;">
							</figure>
						</div>
						</section>
						<section data-auto-animate>
						<h3>Ginzburg–Landau Model</h3>
						<div class="gl-grid">
							<div>
							<div class="fragment fade-in" data-fragment-index="1">
								\[
								U[\varphi] = \frac{\lambda}{2}\!\int_0^1 |\nabla_z \varphi(z)|^2\,dz
								+ \frac{\mu}{4}\!\int_0^1 |1-\varphi(z)^2|^2\,dz
								\]
							</div>
							<ul>
								<li class="fragment fade-in" data-fragment-index="2">
								Dynamics:
								\[
								d\mathbf{x}_t = \mathbf{b}(\mathbf{x}_t,\alpha_t)\,dt + \sqrt{2}\,d\mathbf{W}_t,
								\quad b(\mathbf{x},a) = -\nabla_\mathbf{x} U(\mathbf{x}) + 2\alpha\,\boldsymbol{\omega}
								\]
								</li>
								<li class="fragment fade-in" data-fragment-index="3">
								Trained control matches theoretical optimal:
								\[
								\alpha(t,\mathbf{x};\theta)\approx -\boldsymbol{\omega}\cdot\nabla_{\mathbf{x}}u(t,\mathbf{x})
								\]
								</li>
							</ul>
							</div>

							<div class="fragment fade-in" data-fragment-index="4">
							<figure>
								<img src="Figure/consistence_4D.png"  alt="D=4"  style="max-width:46%;">
								<img src="Figure/consistence_8D.png"  alt="D=8"  style="max-width:46%;">
							</figure>
							<figure style="margin-top:.5em;">
								<img src="Figure/consistence_16D.png" alt="D=16" style="max-width:46%;">
								<img src="Figure/consistence_32D.png" alt="D=32" style="max-width:46%;">
							</figure>
							</div>
						</div>

						<style>
							.gl-grid { display:grid; grid-template-columns: 48% 52%; gap: 18px; align-items:start; text-align:left; }
							.gl-grid img { vertical-align:middle; }
						</style>
						</section>
						<section data-auto-animate>
						<h3>Path Planning</h3>
						<div class="cbo-left">
							<figure class="fragment fade-in">
							<img src="Figure/path.png" alt="Multi-agent paths" style="max-width:100%;">
							<figcaption style="margin-top:.3em;">
								Learned trajectories for multi-agent navigation from initial configurations to targets while avoiding obstacles (2, 4, and 50 agents).
							</figcaption>
							</figure>
						</div>
						</section>
						<section data-auto-animate>
						<h3>Reinforcement Learning</h3>
						<div class="cbo-left">
							<figure class="fragment fade-in">
							<img src="Figure/rl_value.png" alt="RL value comparison" style="max-width:90%;">
							<figcaption style="margin-top:.3em;">
								Value function convergence on Pendulum-v1 (left) and CartPole-v1 (right).
							</figcaption>
							</figure>
						</div>
						</section>
						<section data-auto-animate>
						<h3>Advantages of Adam-CBO</h3>
						<div class="cbo-left">
							<ul>
							<li class="fragment fade-in">Accuracy</li>
							<li class="fragment fade-in">Scalability</li>
							<li class="fragment fade-in">Handles non-convex cases</li>
							</ul>
						</div>
						</section>
						<section data-auto-animate>
						<h3>Summary</h3>
						<div class="cbo-left">
							<ul>
							<li class="fragment fade-in">Gradient-free, model-free method for high-dimensional SOC.</li>
							<li class="fragment fade-in">Key advantages:
								<ul>
								<li class="fragment fade-in">No policy gradient estimation</li>
								<li class="fragment fade-in">No state/action space discretization</li>
								<li class="fragment fade-in">Theoretical convergence guarantees</li>
								</ul>
							</li>
							<li class="fragment fade-in">Demonstrated effectiveness on:
								<ul>
								<li class="fragment fade-in">LQG problems (1D–16D)</li>
								<li class="fragment fade-in">Ginzburg–Landau model (up to 32D)</li>
								<li class="fragment fade-in">Systemic risk mean-field control</li>
								</ul>
							</li>
							<li class="fragment fade-in">
								Code: <a href="https://github.com/Lyuliyao/Adam_CBO_Control">github.com/Lyuliyao/Adam_CBO_Control</a>
							</li>
							</ul>

							<div class="fragment fade-in" style="margin-top:1.2em;">
							<h2 style="margin:0;">Thank you for your attention!</h2>
							</div>
						</div>
						</section>

						<section>
							<h3>
								Thank you for Listening!
							</h3>
						</section>
				</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			Reveal.initialize({
				slideNumber: 'c/t',
				width: 1200,
				height: 800,
				margin: 0, 
				padding: 0,
				menu: {
					titleSelector: 'h1, h2, h3', 
					hideMissingTitles: true
				},
				hash: true,
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>